<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>MEDIFY</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            font-family: Arial, sans-serif;
        }
        #header {
            padding: 10px;
            background-color: #f8f8f8;
            display: flex;
            align-items: center;
        }
        #content {
            flex: 1;
            display: none;
            position: relative;
        }
        #content.active {
            display: block;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: none;
        }
        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 8px solid #f3f3f3;
            border-top: 8px solid #333;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
    </style>
    <script>
        function utf8ToB(str) {
            return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, (_, p1) =>
                String.fromCharCode('0x' + p1)
            ));
        }
        function bToUtf8(str) {
            return decodeURIComponent(Array.prototype.map.call(atob(str), c =>
                '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)
            ).join(''));
        }

        document.addEventListener("DOMContentLoaded", function() {
            fetch('header.html')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('header').innerHTML = data;
                });

            const urlParams = new URLSearchParams(window.location.search);
            const pass = urlParams.get('pass');
            const url = urlParams.get('url');
            const x6 = "ME";
            const q5 = "DIF";
            const z7 = "Y-2";
            const u2 = "0240";
            const g1 = "929";
            const correct = btoa(x6 + q5 + z7 + u2 + g1);
            const content = document.getElementById('content');
            const iframe = document.getElementById('secure-iframe');
            const loading = document.getElementById('loading');

            if (pass === correct && url) {
                content.classList.add('active');
                iframe.src = bToUtf8(url);
                iframe.style.display = 'block';
                loading.style.display = 'block';
                iframe.onload = function() {
                    loading.style.display = 'none';
                };
                window.history.replaceState({}, document.title, window.location.origin);
            } else {
                window.location.href = 'https://medify.com.tw';
            }

            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
            });

            document.addEventListener('touchstart', function(e) {
                if (e.touches.length > 1) {
                    e.preventDefault();
                }
            }, { passive: false });
        });
    </script>
</head>
<body>
    <div id="header"></div>
    <div id="content">
        <div id="loading"></div>
        <iframe id="secure-iframe" src=""></iframe>
    </div>
</body>
</html>
